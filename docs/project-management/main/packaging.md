---
title: 'Packaging'
---

## Overview

We build two kinds of VSIX packages on CI:

* Production: Optimized by webpack. Only contains indispensable files. Ready for deployment.
* Debug: No optimization. Runs on direct output of TypeScript compiler, and full `node_modules`. Intended for debugging and profiling on client.

## Determining modules needed by production package

First find what to check in step 1 and 2. Then determine what are required in step 3 and 4. Be careful about dependence tree.

1. Find dependencies that vsce packs by default:
   * Run `npm ls --production --parseable` to get the list.
   * Run `npm ls --production` to know their relationships.
2. Find modules that webpack can bundle:
   1. Check its configuration `webpack.config.js`.
   2. Run `npx webpack --mode development`.
   3. Check the JavaScript file that it generates.
3. Determine those needed by VS Code:
   * In `package.json`, files under `contributes.markdown.*` are always needed.
   * Modules contributed by `extendMarkdownIt()` are always needed.
4. Examine others manually:
   * Search in the file generated by step 2.

## References

* [Bundling Extensions | Visual Studio Code Extension API](<https://code.visualstudio.com/api/working-with-extensions/bundling-extension>)
* [Dependency Graph | webpack](<https://webpack.js.org/concepts/dependency-graph/>)
* [Mode | webpack](https://webpack.js.org/configuration/mode/)
* [Markdown Extension | Visual Studio Code Extension API](https://code.visualstudio.com/api/extension-guides/markdown-extension)
